# コラム: H2データベースとコンソール

このリポジトリの開発環境では、**H2 Database Engine** というインメモリデータベースを使用しています。
H2はJavaで書かれた軽量なデータベースで、アプリケーションに組み込んで使いやすく、開発やテスト用途で広く利用されています。

- **インメモリデータベースとは？**
  データをディスク上のファイルではなく、コンピュータのメインメモリ上に保持するデータベースです。非常に高速に動作しますが、デフォルトではアプリケーションを停止するとデータは消えてしまいます。（Play Frameworkでは、開発モード中はファイルに永続化する設定になっています。）

Evolutionsでデータベースのスキーマを変更したり、アプリケーションの操作でデータを追加・更新した際に、「本当にデータベースの中身はどうなっているんだろう？」と確認したくなることがあります。
H2は、ブラウザからアクセスできる**データベースコンソール**を提供しており、これを使ってテーブルの構造を見たり、SQLを直接実行してデータを確認したりすることができます。

## H2コンソールへのアクセス方法

1.  **`application.conf` の設定確認**
    `conf/application.conf` ファイルに、H2コンソールを有効にするための設定が含まれていることを確認します。

    ```conf
    # To enable the H2 console, uncomment the following line
    play.h2.console.enabled = true
    ```
    このリポジトリでは既に有効化されています。

2.  **コンソールへのアクセス**
    Play Frameworkのアプリケーションが起動している状態で、ブラウザで以下のURLにアクセスします。

    [http://localhost:9000/console/login.jsp?conn=default](http://localhost:9000/console/login.jsp?conn=default)

    > **Note:**
    > Play 2.8以降では、セキュリティ上の理由から、デフォルトではH2コンソールへのパスがランダム化されることがあります。もし上記URLでアクセスできない場合は、`sbt run` を実行しているコンソールに表示される以下のメッセージを探してください。
    > `[info] p.a.h.H2Console - H2 console is available at http://localhost:9000/console/some-random-path`

3.  **ログイン**
    ログイン画面が表示されます。JDBC URLやユーザー名、パスワードは `application.conf` で設定されたものが自動で入力されているはずなので、何も変更せずに **"接続" (Connect)** ボタンをクリックします。

    ![H2 Console Login](https://www.h2database.com/html/images/console_login.png)

4.  **テーブルの確認**
    ログインに成功すると、SQLを実行できるコンソール画面が表示されます。
    - 画面左側のツリーから `NEWS` テーブルを選択すると、カラムの一覧などを確認できます。
    - SQL入力エリアに `SELECT * FROM news;` と入力して "実行" (Run) ボタンを押すと、前の章でEvolutionsによって挿入された初期データが表示されることを確認できます。

H2コンソールは、開発中にデータベースの状態を把握するための非常に強力なツールです。APIを実装していて意図した通りにデータが保存されない場合など、問題の切り分けに役立ちます。
