# 1-1. アーキテクチャ概要

このチュートリアルで作成するタスク管理アプリケーションの全体像を理解するために、まずは技術スタック、ディレクトリ構成、そしてリクエストが処理される流れについて見ていきましょう。

## 技術スタック

このプロジェクトは、バックエンドとフロントエンドでそれぞれ異なる技術を組み合わせて構築されています。

### バックエンド

- **Play Framework (Java/Scala)**: Webアプリケーションの骨格となるフレームワークです。HTTPリクエストの受付、ビジネスロジックの実行、HTMLの生成などを担当します。
- **Ebean**: JavaのORM（Object-Relational Mapping）ライブラリです。データベースのテーブルとJavaのクラスを対応付け、コードで直感的にデータベース操作を行えるようにします。
- **sbt (The Scala Build Tool)**: Scalaプロジェクトのビルドツールですが、このプロジェクトではJavaコードのコンパイルや、開発サーバーの起動など、バックエンド全体のビルドとタスク実行を管理します。

### フロントエンド

- **Svelte**: UI（ユーザーインターフェース）を構築するためのJavaScriptフレームワークです。高速なパフォーマンスと、シンプルで書きやすいコードが特徴です。
- **webpack**: SvelteやTypeScriptで書かれたソースコードを、ブラウザが解釈できる単一または複数のJavaScriptファイルにまとめる（バンドルする）ためのツールです。

### データベース

- **H2 Database**: 開発時に使用する軽量なインメモリデータベースです。手軽に利用でき、アプリケーションに組み込んで実行できるため、開発環境のセットアップを簡素化します。

## 主要ディレクトリの役割

プロジェクトのルートディレクトリには多くのファイルやディレクトリがありますが、特に重要なものの役割を理解しておきましょう。

- `app/controllers`:
  - ブラウザからのリクエストを最初に受け取るクラス（コントローラー）を配置します。
  - `web/` には画面表示用、`api/` にはデータ通信用のコントローラーを置きます。
- `app/models`:
  - データベースのテーブル構造に対応するクラス（モデル）を配置します。Ebeanがこれらのクラスを使ってデータベース操作を行います。
- `app/repository`:
  - データベースへの具体的なアクセス処理（データの取得、保存、更新、削除など）を担当するクラスを配置します。
- `app/assets/svelte`:
  - Svelteで作成するUIコンポーネントのソースコードをすべて配置します。画面（`screens`）、共通レイアウト（`layouts`）、再利用可能な部品（`components`）などに分かれています。
- `conf`:
  - アプリケーションの設定ファイル（`application.conf`）、ルーティング設定（`routes`）、DBマイグレーションスクリプト（`evolutions/`）などを配置します。
- `public`:
  - 画像ファイルやCSSフレームワークなど、ビルド処理を必要としない静的なファイルを配置します。

## リクエストから画面表示までの流れ

ユーザーがブラウザでページにアクセスしてから画面が表示されるまで、裏側では以下のような処理が連携して行われています。

1.  **ブラウザからのリクエスト**: ユーザーがURLにアクセスすると、リクエストがPlay Frameworkに送信されます。
2.  **ルーティング (`conf/routes`)**: Play Frameworkは `conf/routes` ファイルを参照し、リクエストされたURLに対応するコントローラーのアクション（メソッド）を特定します。
3.  **コントローラーの処理 (`app/controllers`)**: 呼び出されたコントローラーは、必要に応じてモデルやリポジトリを使ってデータベースからデータを取得し、ビジネスロジックを実行します。
4.  **ビューのレンダリング**: コントローラーは処理結果をビュー（`app/views`にあるScalaテンプレート）に渡し、HTMLの生成を指示します。このプロジェクトでは、`screen.scala.html` がSvelteコンポーネントをマウントするためのJavaScriptコードを含んだHTMLを生成します。
5.  **HTMLレスポンス**: Play Frameworkは生成されたHTMLをブラウザに返します。
6.  **Svelteコンポーネントのマウント**: HTMLを受け取ったブラウザは、`<script>`タグで読み込まれたJavaScriptを実行します。このJavaScript（webpackによってバンドルされたもの）が、指定されたSvelteコンポーネント（例: `Tasks/Page.svelte`）をHTMLの特定の要素（例: `<div id="app">`）に描画（マウント）します。

これにより、ユーザーは動的なWebアプリケーションの画面を見ることができます。APIを呼び出す場合は、この流れの3番以降がJSONを返す処理に置き換わります。

---

次の章では、このアプリケーションを実際に動かすための開発環境のセットアップ方法を学びます。
