# 3-3. コラム: H2データベースとコンソール

このチュートリアルでは、開発用のデータベースとして「H2 Database Engine」を使用しています。この章では、H2データベースとは何か、そしてその管理ツールであるH2コンソールの使い方について解説します。

## H2データベースとは

[H2 Database Engine](https://www.h2database.com/) は、Javaで書かれたオープンソースのリレーショナルデータベース管理システム（RDBMS）です。

最大の特徴は、その**軽量さと手軽さ**にあります。
MySQLやPostgreSQLのように専用のサーバープロセスをインストール・起動する必要がなく、アプリケーションにライブラリとして組み込んで使用できます（**組み込みモード**）。

また、データをファイルに保存するだけでなく、アプリケーションの起動中だけメモリ上にデータを保持する**インメモリモード**で動作させることも可能です。

これらの特徴から、H2は以下のような用途で広く利用されています。
- **開発環境**: 開発者がすばやく環境を構築し、アプリケーションを動かすため。
- **単体テスト**: テスト実行のたびにクリーンなデータベースをメモリ上に作成し、テスト間の独立性を保つため。
- **小規模なアプリケーション**: 専用のDBサーバーを立てるまでもない小規模なアプリケーションのデータストアとして。

このプロジェクトでは、開発サーバー（`sbt run`）を起動すると、H2データベースがインメモリモードで自動的に起動するように設定されています。サーバーを停止するとデータは消えてしまいますが、開発中はEvolutionsによって常に同じテーブル構造が再現されるため問題ありません。

## H2コンソールの使い方

H2データベースには、ブラウザベースの管理ツール「H2コンソール」が付属しています。これを使うと、テーブルの構造を確認したり、SQLを直接実行してデータを参照・操作したりすることができ、開発やデバッグに非常に役立ちます。

H2コンソールを有効にするには、設定ファイルを確認する必要があります。

`conf/application.conf` ファイルを開き、`h2-console` というキーワードで検索してみてください。以下のような設定が見つかるはずです。

**`conf/application.conf`**
```
play.h2.console.enabled=true
play.h2.console.path=/h2-console
```
この設定により、H2コンソールが有効になり、`/h2-console` というパスでアクセスできるようになっています。

それでは、実際にアクセスしてみましょう。
`sbt run` が起動している状態で、ブラウザで以下のURLを開いてください。

[http://localhost:9000/h2-console](http://localhost:9000/h2-console)

ログイン画面が表示されます。
`JDBC URL` の項目が `jdbc:h2:mem:play` となっていることを確認してください。これは、`play` という名前のインメモリデータベースに接続するという意味です。

![H2 Console Login](https://www.playframework.com/documentation/3.0.x/images/h2-console.png)
*(画像はPlay Framework公式ドキュメントより)*

**[接続]** ボタンをクリックすると、コンソール画面に移動します。

画面の左側には、現在接続しているデータベース内のテーブル一覧が表示されます。前の章で作成した `TASK` テーブルが見えるはずです。

`TASK` テーブル名をクリックすると、画面右側のSQL入力エリアに `SELECT * FROM TASK` というクエリが自動で入力されます。この状態で **[実行]** ボタンを押すと、テーブルに保存されているデータを一覧で確認できます。（現時点ではまだデータがないので空のはずです）

このように、H2コンソールを使えば、アプリケーションの裏側でデータが正しく保存・更新されているかを簡単に確認できます。今後の開発でAPIを実装した際には、このコンソールが強力なデバッグツールとなるでしょう。
