# 3-3. コラム: H2データベースとコンソール

このチュートリアルでは、開発用のデータベースとして「H2 Database Engine」を使用しています。この章では、H2データベースとは何か、そしてその管理ツールであるH2コンソールの使い方について解説します。

## H2データベースとは

[H2 Database Engine](https://www.h2database.com/) は、Javaで書かれたオープンソースのリレーショナルデータベース管理システム（RDBMS）です。

最大の特徴は、その**軽量さと手軽さ**にあります。
MySQLやPostgreSQLのように専用のサーバープロセスをインストール・起動する必要がなく、アプリケーションにライブラリとして組み込んで使用できます（**組み込みモード**）。

また、データをファイルに保存するだけでなく、アプリケーションの起動中だけメモリ上にデータを保持する**インメモリモード**で動作させることも可能です。

これらの特徴から、H2は以下のような用途で広く利用されています。
- **開発環境**: 開発者がすばやく環境を構築し、アプリケーションを動かすため。
- **単体テスト**: テスト実行のたびにクリーンなデータベースをメモリ上に作成し、テスト間の独立性を保つため。
- **小規模なアプリケーション**: 専用のDBサーバーを立てるまでもない小規模なアプリケーションのデータストアとして。

このプロジェクトでは、開発サーバー（`sbt run`）を起動すると、H2データベースがインメモリモードで自動的に起動するように設定されています。サーバーを停止するとデータは消えてしまいますが、開発中はEvolutionsによって常に同じテーブル構造が再現されるため問題ありません。

## H2コンソールの使い方

H2データベースには、ブラウザベースの管理ツール「H2コンソール」が付属しています。これを使うと、テーブルの構造を確認したり、SQLを直接実行してデータを参照・操作したりすることができ、開発やデバッグに非常に役立ちます。

H2コンソールは、sbtから簡単に起動できます。
まず、ターミナルで `sbt` と入力し、sbtコンソールを起動します。

```bash
sbt
```

sbtコンソールが起動したら、`h2-browser` と入力して実行してください。

```
> h2-browser
```

自動的にブラウザが立ち上がり、H2コンソールのログイン画面が表示されます。
もしブラウザが起動しない場合は、[http://localhost:8082](http://localhost:8082) を手動で開いてください。

ログイン画面では、以下の情報を入力して接続します。これらの情報は `conf/application.conf` ファイルで設定されています。

- **ドライバクラス (Driver Class)**: `org.h2.Driver`
- **JDBC URL**: `jdbc:h2:mem:play`
- **ユーザ名 (User Name)**: `sa`
- **パスワード (Password)**: (空欄のまま)

![H2 Console Login](https://www.playframework.com/documentation/3.0.x/images/h2-console.png)
*(画像はPlay Framework公式ドキュメントより)*

**[接続]** ボタンをクリックすると、コンソール画面に移動します。

画面の左側には、現在接続しているデータベース内のテーブル一覧が表示されます。前の章で作成した `TASK` テーブルが見えるはずです。

`TASK` テーブル名をクリックすると、画面右側のSQL入力エリアに `SELECT * FROM TASK` というクエリが自動で入力されます。この状態で **[実行]** ボタンを押すと、テーブルに保存されているデータを一覧で確認できます。（現時点ではまだデータがないので空のはずです）

このように、H2コンソールを使えば、アプリケーションの裏側でデータが正しく保存・更新されているかを簡単に確認できます。今後の開発でAPIを実装した際には、このコンソールが強力なデバッグツールとなるでしょう。
